%% STEP 0

clear;

mr = 0.198;
mp = 0.158;
lr = 0.155;
lp = 0.135;
Jr = (1/3)*mr*(0.15^2 + 0.035^2);
Jp = (1/12)*mp*(0.15^2 + 0.035^2);
K = 0.2254;
R = 0.1051;

a1 = mr*(lr/2)^2 + Jr + mp*lr;
a2 = 0.5*mp*lr*lp;
a3 = (K^2)/R;
a4 = K/R;
b1 = mp*(lp/2)^2 + Jp;
b2 = 0.5*mp*lr*lp;
b3 = 0.5*mp*9.81*lp;
g1 = a1 - a2*b2/b1;
g2 = a2*b3/b1;
g3 = b1 - b2*a2/a1;
g4 = b2*a3/a1;
g5 = b2*a4/a1;

%% STEP 1

A = [0,     1,          0,          0;
     0,     -a3/g1,     -g2/g1,     0;
     0,     0,          0,          1;
     0,     g4/g3,      b3/g3,      0];

B = [0; a4/g1; 0; -g5/g3];

Q = [10, 0,  0,  0;
     0,  1, 0,  0;
     0,  0,  50, 0;
     0,  0,  0,  3];
 
R = 1;

%% STEP 2

[C,~,~] = lqr(A, B, Q, R);
L = eig(A - B*C);

fprintf('const double c1 = %.4f, c2 = %.4f, c3 = %.4f, c4 = %.4f;\n', C(1), C(2), C(3), C(4));





